<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    <title>psn-php by Tustin | Authentication with PSN</title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="stylesheets/styles.css">
    <meta name="viewport" content="width=device-width">

    <meta property="og:title" content="PHP wrapper for the PSN API" />
    <meta property="og:image" content="https://www.playstation.com/en-gb/content/dam/sitefurniture/psn-status/meganav/meganav-icon-get-help-network-status-01-eu-09sep15.png" />
    <meta property="og:url" content="https://tustin.github.io/psn-php/" />
    <meta property="og:description" content="Easy to use PHP wrapper to communicate with the PSN API" />

    <meta itemprop="name" content="psn-php">
    <meta itemprop="description" content="Easy to use PHP wrapper to communicate with the PSN API">
    <meta itemprop="image" content="https://www.playstation.com/en-gb/content/dam/sitefurniture/psn-status/meganav/meganav-icon-get-help-network-status-01-eu-09sep15.png">
    <meta itemprop="codeRepository" content="https://github.com/tustin/psn-php">

    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@Tusticles" />
    <meta name="twitter:title" content="PHP wrapper for the PSN API" />
    <meta name="twitter:description" content="Easy to use PHP wrapper to communicate with the PSN API" />
    <meta name="twitter:image" content="https://www.playstation.com/en-gb/content/dam/sitefurniture/psn-status/meganav/meganav-icon-get-help-network-status-01-eu-09sep15.png" />
    <meta name="twitter:url" content="https://tustin.github.io/psn-php/" />

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container-fluid">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="index.html">psn-php</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li><a href="https://github.com/tustin/psn-php"><i class="fa fa-code"></i> Code</a></li>
            <li><a href="index.html">Getting Started</a></li>
            <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Features <span class="caret"></span></a>
                <ul class="dropdown-menu">
                  <li><a href="auth.html">Authenticating with PSN</a></li>
                  <li role="separator" class="divider"></li>
                  <li><a href="user.html">User</a></li>
                  <li><a href="friends.html">Friends</a></li>
                  <li><a href="trophies.html">Trophies</a></li>
                  <li><a href="messaging.html">Messaging</a></li>
                  <li><a href="communities.html">Communities</a></li>
                </ul>
            </li>
          </ul>
          <ul class="nav navbar-nav pull-right">
            <li><a href="https://github.com/tustin/psn-php/issues"><img src="https://img.shields.io/github/issues/Tustin/psn-php.svg"></a></li>
            <li><a href="https://github.com/Tustin/psn-php/stargazers"><img src="https://img.shields.io/github/stars/Tustin/psn-php.svg"></a></li>
            <li><a href="https://raw.githubusercontent.com/Tustin/psn-php/master/LICENSE"><img src="https://img.shields.io/badge/license-MIT-blue.svg"></a></li>
          </ul>
        </div>
      </div>
    </nav>

    <div class="container">
      <h3>Authenticating</h3>
      <hr>
      <p>Authenticating is easy. The \PSN\Auth class has a custom exception that can be caught whenever there was an error with the authentication process (such as bad credentials, suspensions from PSN, or other issues) which you can use to display an appropriate error. Try authenticating like so:</p>
      <pre>try 
{
    $account = new \PSN\Auth("test@psn.com", "password");
} 
catch (\PSN\AuthException $e)
{
    header("Content-Type: application/json");
    die($e->GetError());
}</pre>
      <p>You can customize how the exception is handled, but by default this will just output the plaintext json to the screen.</p><br>
      <p>If the process was successful, you can use $account to grab the OAuth tokens for the account:</p>
      <pre>$tokens = $account->GetTokens();</pre>
      <p>$tokens will now contain an array with two types of OAuth tokens:</p>
      <ul>
        <li>Authorization token ["oauth"] - Used when making requests on behalf of the user</li>
        <li>Refresh token ["refresh"] - Used for generating a new pair of Authorization and Refresh tokens without needing to login with account credentials</li>
      </ul>
      <p>With your set of OAuth tokens, you can now begin making API requests.</p>
      <h3>Obtaining New OAuth Tokens</h3>
      <hr>
      <p>If you've already logged in with your account details and saved your OAuth tokens, you can obtain fresh new tokens without needing to login again using your existing Refresh token:</p>
      <pre>$new_tokens = \PSN\Auth::GrabNewTokens('2c4e014b-xxxx-47d4-xxxx-b274107457f2');</pre>
      <p>The string passed into GrabNewTokens is your refresh token. Ideally, you would store this value in a database or external file, and then grab the token and pass it into the GrabNewTokens function. $new_tokens will now contain brand new Authorization and Refresh tokens.</p>
    </div>
  </body>
  <script
  src="https://code.jquery.com/jquery-3.1.1.min.js"
  integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
  crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
</html>
